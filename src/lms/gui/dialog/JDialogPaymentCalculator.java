/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package lms.gui.dialog;

import java.awt.event.KeyEvent;
import java.text.DecimalFormat;
import javax.swing.JOptionPane;
import lms.util.NumberInput;

/**
 *
 * @author admin
 */
public class JDialogPaymentCalculator extends javax.swing.JDialog {

    private DecimalFormat df = new DecimalFormat("##,##0.00");
    private Double total;
    private static Boolean pay = false;
    private lms.gui.JFrameMainSLM mainMenu;

    /**
     * Creates new form JDialogPaymentCalculator
     */
    public JDialogPaymentCalculator(lms.gui.JFrameMainSLM parent, boolean modal, Double total) {
        super(parent, modal);
        this.setTotal(total);
        this.mainMenu = parent;
        initComponents();
        jTextFieldDue.setText(String.valueOf(df.format(this.getTotal())));
        jTextFieldChange.setEnabled(false);
        jTextFieldDue.setEnabled(false);
        jButton1.setEnabled(false);
        jTextFieldChange.setText("0.00");
        new NumberInput().doubleValidator(jTextFieldCash);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        jTextFieldChange = new javax.swing.JTextField();
        jTextFieldCash = new javax.swing.JTextField();
        jTextFieldDue = new javax.swing.JTextField();
        jButton1 = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        setTitle("Payment");
        getContentPane().setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jLabel1.setFont(new java.awt.Font("Courier New", 1, 18)); // NOI18N
        jLabel1.setForeground(new java.awt.Color(51, 51, 51));
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel1.setText("Due");
        getContentPane().add(jLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(62, 119, 76, 34));

        jLabel2.setFont(new java.awt.Font("Courier New", 1, 18)); // NOI18N
        jLabel2.setForeground(new java.awt.Color(51, 51, 51));
        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel2.setText("Cash");
        getContentPane().add(jLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(62, 67, 76, 34));

        jLabel3.setFont(new java.awt.Font("Courier New", 1, 18)); // NOI18N
        jLabel3.setForeground(new java.awt.Color(51, 51, 51));
        jLabel3.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jLabel3.setText("Change");
        getContentPane().add(jLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(60, 170, 76, 34));

        jTextFieldChange.setFont(new java.awt.Font("Courier New", 1, 24)); // NOI18N
        jTextFieldChange.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        getContentPane().add(jTextFieldChange, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 170, 140, 34));

        jTextFieldCash.setFont(new java.awt.Font("Courier New", 1, 24)); // NOI18N
        jTextFieldCash.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        jTextFieldCash.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusGained(java.awt.event.FocusEvent evt) {
                jTextFieldCashFocusGained(evt);
            }
        });
        jTextFieldCash.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jTextFieldCashKeyPressed(evt);
            }
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jTextFieldCashKeyReleased(evt);
            }
        });
        getContentPane().add(jTextFieldCash, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 67, 140, 34));

        jTextFieldDue.setFont(new java.awt.Font("Courier New", 1, 24)); // NOI18N
        jTextFieldDue.setHorizontalAlignment(javax.swing.JTextField.RIGHT);
        getContentPane().add(jTextFieldDue, new org.netbeans.lib.awtextra.AbsoluteConstraints(140, 119, 140, 34));

        jButton1.setFont(new java.awt.Font("Courier New", 0, 14)); // NOI18N
        jButton1.setMnemonic('O');
        jButton1.setText("OK");
        jButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton1ActionPerformed(evt);
            }
        });
        getContentPane().add(jButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(130, 240, 100, 40));

        setSize(new java.awt.Dimension(348, 339));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void jTextFieldCashFocusGained(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_jTextFieldCashFocusGained

    }//GEN-LAST:event_jTextFieldCashFocusGained

    private void jTextFieldCashKeyPressed(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextFieldCashKeyPressed
        if (evt.getKeyCode() == KeyEvent.VK_ENTER) {
            if (jTextFieldCash.getText().toString().length() == 0) {
                dispose();
            } else if (Double.parseDouble(jTextFieldCash.getText()) < getTotal()) {
                JOptionPane.showMessageDialog(mainMenu, "Your cash is lower than amount due. try again.", "Error input!!", JOptionPane.WARNING_MESSAGE);
                return;
            } else {
                this.setPay(true);
                this.dispose();
            }
        }
    }//GEN-LAST:event_jTextFieldCashKeyPressed

    private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
        if (jTextFieldCash.getText().toString().length() == 0) {
            dispose();
        } else if (Double.parseDouble(jTextFieldCash.getText()) < getTotal()) {
            JOptionPane.showMessageDialog(mainMenu, "Your cash is lower than amount due. try again.", "Error input!!", JOptionPane.WARNING_MESSAGE);
            return;
        } else {
            this.setPay(true);
            this.dispose();
        }
    }//GEN-LAST:event_jButton1ActionPerformed

    private void jTextFieldCashKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextFieldCashKeyReleased
        Double change = 0.0;
        Double cash = 0.0;

        if (jTextFieldCash.getText().length() < 1) {
            cash = 0.0;
            jTextFieldChange.setText("0.00");
            return;
        } else {
            cash = Double.parseDouble(jTextFieldCash.getText());
            change = cash - getTotal();
        }

        jTextFieldChange.setText(String.valueOf(df.format(change)));
        if (change >= 0) {
            jButton1.setEnabled(true);
        } else {
            jButton1.setEnabled(false);
        }
    }//GEN-LAST:event_jTextFieldCashKeyReleased


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButton1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JTextField jTextFieldCash;
    private javax.swing.JTextField jTextFieldChange;
    private javax.swing.JTextField jTextFieldDue;
    // End of variables declaration//GEN-END:variables

    /**
     * @return the total
     */
    public Double getTotal() {
        return total;
    }

    /**
     * @param total the total to set
     */
    public void setTotal(Double total) {
        this.total = total;
    }

    /**
     * @return the pay
     */
    public static Boolean getPay() {
        return pay;
    }

    /**
     * @param aPay the pay to set
     */
    public static void setPay(Boolean aPay) {
        pay = aPay;
    }
}
